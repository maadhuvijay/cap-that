<!-- Generated by SpecStory, Markdown v2.1.0 -->

<!-- cursor Session c50cc8d4-f9d1-48fe-9067-2c8a7d4b52c6 (2025-12-17 19:24Z) -->

# Speckit task T011 (2025-12-17 19:24Z)

_**User (2025-12-17 02:58Z)**_

/speckit.tasks T011

--- Cursor Command: speckit.tasks.md ---
---
description: Generate an actionable, dependency-ordered tasks.md for the feature based on available design artifacts.
handoffs: 
  - label: Analyze For Consistency
    agent: speckit.analyze
    prompt: Run a project analysis for consistency
    send: true
  - label: Implement Project
    agent: speckit.implement
    prompt: Start the implementation in phases
    send: true
---

## User Input

```text
T011
```

You **MUST** consider the user input before proceeding (if not empty).

## Outline

1. **Setup**: Run `.specify/scripts/bash/check-prerequisites.sh --json` from repo root and parse FEATURE_DIR and AVAILABLE_DOCS list. All paths must be absolute. For single quotes in args like "I'm Groot", use escape syntax: e.g 'I'\''m Groot' (or double-quote if possible: "I'm Groot").

2. **Load design documents**: Read from FEATURE_DIR:
   - **Required**: plan.md (tech stack, libraries, structure), spec.md (user stories with priorities)
   - **Optional**: data-model.md (entities), contracts/ (API endpoints), research.md (decisions), quickstart.md (test scenarios)
   - Note: Not all projects have all documents. Generate tasks based on what's available.

3. **Execute task generation workflow**:
   - Load plan.md and extract tech stack, libraries, project structure
   - Load spec.md and extract user stories with their priorities (P1, P2, P3, etc.)
   - If data-model.md exists: Extract entities and map to user stories
   - If contracts/ exists: Map endpoints to user stories
   - If research.md exists: Extract decisions for setup tasks
   - Generate tasks organized by user story (see Task Generation Rules below)
   - Generate dependency graph showing user story completion order
   - Create parallel execution examples per user story
   - Validate task completeness (each user story has all needed tasks, independently testable)

4. **Generate tasks.md**: Use `.specify/templates/tasks-template.md` as structure, fill with:
   - Correct feature name from plan.md
   - Phase 1: Setup tasks (project initialization)
   - Phase 2: Foundational tasks (blocking prerequisites for all user stories)
   - Phase 3+: One phase per user story (in priority order from spec.md)
   - Each phase includes: story goal, independent test criteria, tests (if requested), implementation tasks
   - Final Phase: Polish & cross-cutting concerns
   - All tasks must follow the strict checklist format (see Task Generation Rules below)
   - Clear file paths for each task
   - Dependencies section showing story completion order
   - Parallel execution examples per story
   - Implementation strategy section (MVP first, incremental delivery)

5. **Report**: Output path to generated tasks.md and summary:
   - Total task count
   - Task count per user story
   - Parallel opportunities identified
   - Independent test criteria for each story
   - Suggested MVP scope (typically just User Story 1)
   - Format validation: Confirm ALL tasks follow the checklist format (checkbox, ID, labels, file paths)

Context for task generation: T011

The tasks.md should be immediately executable - each task must be specific enough that an LLM can complete it without additional context.

## Task Generation Rules

**CRITICAL**: Tasks MUST be organized by user story to enable independent implementation and testing.

**Tests are OPTIONAL**: Only generate test tasks if explicitly requested in the feature specification or if user requests TDD approach.

### Checklist Format (REQUIRED)

Every task MUST strictly follow this format:

```text
- [ ] [TaskID] [P?] [Story?] Description with file path
```

**Format Components**:

1. **Checkbox**: ALWAYS start with `- [ ]` (markdown checkbox)
2. **Task ID**: Sequential number (T001, T002, T003...) in execution order
3. **[P] marker**: Include ONLY if task is parallelizable (different files, no dependencies on incomplete tasks)
4. **[Story] label**: REQUIRED for user story phase tasks only
   - Format: [US1], [US2], [US3], etc. (maps to user stories from spec.md)
   - Setup phase: NO story label
   - Foundational phase: NO story label  
   - User Story phases: MUST have story label
   - Polish phase: NO story label
5. **Description**: Clear action with exact file path

**Examples**:

- ‚úÖ CORRECT: `- [ ] T001 Create project structure per implementation plan`
- ‚úÖ CORRECT: `- [ ] T005 [P] Implement authentication middleware in src/middleware/auth.py`
- ‚úÖ CORRECT: `- [ ] T012 [P] [US1] Create User model in src/models/user.py`
- ‚úÖ CORRECT: `- [ ] T014 [US1] Implement UserService in src/services/user_service.py`
- ‚ùå WRONG: `- [ ] Create User model` (missing ID and Story label)
- ‚ùå WRONG: `T001 [US1] Create model` (missing checkbox)
- ‚ùå WRONG: `- [ ] [US1] Create User model` (missing Task ID)
- ‚ùå WRONG: `- [ ] T001 [US1] Create model` (missing file path)

### Task Organization

1. **From User Stories (spec.md)** - PRIMARY ORGANIZATION:
   - Each user story (P1, P2, P3...) gets its own phase
   - Map all related components to their story:
     - Models needed for that story
     - Services needed for that story
     - Endpoints/UI needed for that story
     - If tests requested: Tests specific to that story
   - Mark story dependencies (most stories should be independent)

2. **From Contracts**:
   - Map each contract/endpoint ‚Üí to the user story it serves
   - If tests requested: Each contract ‚Üí contract test task [P] before implementation in that story's phase

3. **From Data Model**:
   - Map each entity to the user story(ies) that need it
   - If entity serves multiple stories: Put in earliest story or Setup phase
   - Relationships ‚Üí service layer tasks in appropriate story phase

4. **From Setup/Infrastructure**:
   - Shared infrastructure ‚Üí Setup phase (Phase 1)
   - Foundational/blocking tasks ‚Üí Foundational phase (Phase 2)
   - Story-specific setup ‚Üí within that story's phase

### Phase Structure

- **Phase 1**: Setup (project initialization)
- **Phase 2**: Foundational (blocking prerequisites - MUST complete before user stories)
- **Phase 3+**: User Stories in priority order (P1, P2, P3...)
  - Within each story: Tests (if requested) ‚Üí Models ‚Üí Services ‚Üí Endpoints ‚Üí Integration
  - Each phase should be a complete, independently testable increment
- **Final Phase**: Polish & Cross-Cutting Concerns

--- End Command ---

---

_**Agent (model default, mode Agent)**_



---


Checking prerequisites and loading design documents to generate tasks.md for T011.


---

<tool-use data-tool-type="shell" data-tool-name="run_terminal_cmd">
<details><summary>Tool use: **run_terminal_cmd** ‚Ä¢ Run command: cd c:\dev\capthat\cap-that && bash .specify/scripts/bash/check-prerequisites.sh --json</summary>

```bash
cd c:\dev\capthat\cap-that && bash .specify/scripts/bash/check-prerequisites.sh --json
```

```
At C:\Users\maadh\AppData\Local\Temp\ps-script-0a00e64b-e316-4128-8f08-c81aeb9f294f.ps1:7 char:28
+ cd c:\dev\capthat\cap-that &amp;&amp; bash .specify/scripts/bash/check-prereq ...
+                            ~~
The token '&amp;&amp;' is not a valid statement separator in this version.
    + CategoryInfo          : ParserError: (:) [], ParentContainsErrorRecordException
    + FullyQualifiedErrorId : InvalidEndOfLine
 

```
</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** ‚Ä¢ Read file: .specify/scripts/bash/setup-plan.sh</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="generic" data-tool-name="glob_file_search">
<details>
<summary>Tool use: **glob_file_search** ‚Ä¢ Searched codebase "**/tasks-template.md" ‚Ä¢ **0** result in **1** directory</summary>

Directory: **c:\dev\capthat\cap-that** (0 file)

</details>
</tool-use>

---



---


Using PowerShell syntax and locating the tasks template:


---

<tool-use data-tool-type="shell" data-tool-name="run_terminal_cmd">
<details><summary>Tool use: **run_terminal_cmd** ‚Ä¢ Run command: cd c:\dev\capthat\cap-that; bash .specify/scripts/bash/check-prerequisites.sh --json</summary>

```bash
cd c:\dev\capthat\cap-that; bash .specify/scripts/bash/check-prerequisites.sh --json
```

```
bash : The term 'bash' is not recognized as the name of a cmdlet, function, script file, or operable program. Check 
the spelling of the name, or if a path was included, verify that the path is correct and try again.
At C:\Users\maadh\AppData\Local\Temp\ps-script-562239fe-4c88-423e-b103-186a620cacd3.ps1:7 char:29
+ cd c:\dev\capthat\cap-that; bash .specify/scripts/bash/check-prerequi ...
+                             ~~~~
    + CategoryInfo          : ObjectNotFound: (bash:String) [], CommandNotFoundException
    + FullyQualifiedErrorId : CommandNotFoundException
 

```
</details>
</tool-use>

---

<tool-use data-tool-type="generic" data-tool-name="glob_file_search">
<details>
<summary>Tool use: **glob_file_search** ‚Ä¢ Searched codebase "**/.specify/templates/*.md" ‚Ä¢ **0** result in **1** directory</summary>

Directory: **c:\dev\capthat\cap-that** (0 file)

</details>
</tool-use>

---

<tool-use data-tool-type="generic" data-tool-name="list_dir">
<details>
            <summary>Tool use: **list_dir** ‚Ä¢ Listed directory, 0 results</summary>
        
No results found
</details>
</tool-use>

---



---


Reading the prerequisites script and tasks template, and checking T011:


---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** ‚Ä¢ Read file: .specify/scripts/bash/check-prerequisites.sh</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** ‚Ä¢ Read file: .specify/templates/tasks-template.md</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** ‚Ä¢ Read file: specs/001-capthat-extension/tasks.md</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="search" data-tool-name="grep">
<details>
<summary>Tool use: **grep** ‚Ä¢ Grep for "T011" in "specs/001-capthat-extension" ‚Ä¢ 1 match</summary>

Output mode: content


| File | Content | Line |
|------|------|------|
| `specs/001-capthat-extension\tasks.md` | `- [ ] T011 Test extension loads in Chrome via "Load unpacked" without errors` | L47 |


</details>
</tool-use>

---



---


Reading the common script to understand path resolution, then loading the design documents:


---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** ‚Ä¢ Read file: .specify/scripts/bash/common.sh</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** ‚Ä¢ Read file: specs/001-capthat-extension/plan.md</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** ‚Ä¢ Read file: specs/001-capthat-extension/spec.md</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** ‚Ä¢ Read file: specs/001-capthat-extension/data-model.md</summary>

</details>
</tool-use>

---



---


Checking for contracts and research documents:


---

<tool-use data-tool-type="generic" data-tool-name="list_dir">
<details>
            <summary>Tool use: **list_dir** ‚Ä¢ Listed directory, 0 results</summary>
        
No results found
</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** ‚Ä¢ Read file: specs/001-capthat-extension/research.md</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** ‚Ä¢ Read file: specs/001-capthat-extension/contracts/messages.ts</summary>

</details>
</tool-use>

---



---


Generating tasks.md from the design documents. Creating the initial todo list:


---

<tool-use data-tool-type="task" data-tool-name="todo_write">
<details><summary>Tool use: **todo_write** ‚Ä¢ Todo List</summary>

- [x] Read all design documents (plan.md, spec.md, data-model.md, contracts, research.md)
- [-] Generate tasks.md organized by user story with proper checklist format
- [ ] Validate task format and dependencies

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** ‚Ä¢ Read file: specs/001-capthat-extension/contracts/api-contracts.md</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** ‚Ä¢ Read file: specs/001-capthat-extension/contracts/message-contracts.md</summary>

</details>
</tool-use>

---



---


Generating tasks.md based on the design documents:


---

<tool-use data-tool-type="write" data-tool-name="write">

<details><summary>Tool use: **write** ‚Ä¢ Edit file: specs/001-capthat-extension/tasks.md</summary>

**Chunk 1**
Lines added: 1, lines removed: 1

```diff
@@ -6,5 +6,5 @@
  
  **Input**: Design documents from &#96;/specs/001-capthat-extension/&#96;  
- **Prerequisites**: implementation-plan.md (required), spec.md (required for user stories)  
+ **Prerequisites**: plan.md (required), spec.md (required for user stories), data-model.md, contracts/, research.md  
  **Feature Branch**: &#96;001-capthat-extension&#96;  
  **Generated**: 2025-01-27  
```

**Chunk 2**
Lines added: 6, lines removed: 6

```diff
@@ -99,13 +99,13 @@
  - Extension loads without errors
  - Extension shows icon and name "CapThat" in extensions list
- - Reloading extension reflects code changes after rebuild
+ - Reload reflects code changes after rebuild
...
- - [ ] T029 [US1] Create extension icon files at &#96;extension/icons/icon16.png&#96;, &#96;extension/icons/icon48.png&#96;, &#96;extension/icons/icon128.png&#96;
- - [ ] T030 [US1] Verify extension name "CapThat" is configured in &#96;extension/manifest.json&#96; (name field)
- - [ ] T031 [US1] Verify build output generates valid extension structure in &#96;build/extension/&#96; (run &#96;npm run build:extension&#96; and verify manifest.json, icons, and compiled JS files exist)
- - [ ] T032 [US1] Test extension loads via "Load unpacked" in chrome://extensions (open chrome://extensions, enable Developer mode, click "Load unpacked", select &#96;build/extension/&#96; directory)
- - [ ] T033 [US1] Test extension reload reflects code changes after rebuild (make code change, rebuild, reload extension in chrome://extensions, verify change appears)
+ - [ ] T029 [US1] Add extension icon assets to &#96;extension/icons/&#96; directory (16x16, 48x48, 128x128 PNG files)
+ - [ ] T030 [US1] Configure icon paths in &#96;extension/manifest.json&#96; (icons field with all sizes)
+ - [ ] T031 [US1] Set extension name to "CapThat" in &#96;extension/manifest.json&#96; (name field)
+ - [ ] T032 [US1] Verify build output generates valid extension package
+ - [ ] T033 [US1] Test extension reload functionality (make code change, rebuild, reload extension, verify changes appear)
  
  **Checkpoint**: At this point, User Story 1 should be fully functional and testable independently
```

**Chunk 3**
Lines added: 536, lines removed: 561

```diff
@@ -115,577 +115,552 @@
  ## Phase 4: User Story 2 - Show CapThat Panel UI (Priority: P1) üéØ MVP
  
- **Goal**: Users can open CapThat panel and see complete UI with title, grid, and action buttons.
+ **Goal**: Users can open the CapThat panel and see the complete UI with title, grid, and action buttons.
...
- **Independent Test**: Click extension action button (or open side panel), verify UI displays with title "CapThat!", empty grid with N slots, buttons (Clear, Export JSON, Export CapBoard, Export Individual Caps), styled with Tailwind at desktop widths.
+ **Independent Test**: Open extension panel (via action button, side panel, or injected overlay), verify UI displays correctly with title "CapThat!", empty grid with N slots, buttons (Clear, Export JSON, Export CapBoard, Export Individual Caps), and styled with Tailwind at desktop widths.
...
- - UI displays title "CapThat!", empty grid with N slots, action buttons
- - UI is styled with Tailwind and usable at desktop widths
- 
- ### Design System Setup
- 
- - [ ] T034 [US2] Configure Tailwind for dark mode in &#96;extension/ui/tailwind.config.js&#96;
- - [ ] T035 [US2] Define color palette (teal/cyan/electric blue) in &#96;extension/ui/tailwind.config.js&#96;
- - [ ] T036 [US2] Create utility classes for glassmorphism in &#96;extension/ui/globals.css&#96; (backdrop-blur effects)
- - [ ] T037 [US2] Define typography scale in &#96;extension/ui/tailwind.config.js&#96;
- 
- ### UI Components
- 
- - [ ] T038 [P] [US2] Implement Header component at &#96;extension/ui/components/Header.tsx&#96; (browser-like header with URL bar)
- - [ ] T039 [P] [US2] Implement ActionButton component at &#96;extension/ui/components/ActionButton.tsx&#96; (reusable button with hover/active states)
- - [ ] T040 [P] [US2] Implement ImageCard component at &#96;extension/ui/components/ImageCard.tsx&#96; (image card with "Cap!" button overlay)
- - [ ] T041 [P] [US2] Implement ImageGrid component at &#96;extension/ui/components/ImageGrid.tsx&#96; (grid layout with empty state placeholders)
- - [ ] T042 [P] [US2] Implement CapBoardPanel component at &#96;extension/ui/components/CapBoardPanel.tsx&#96; (right-side panel with board grid and action buttons)
- 
- ### Side Panel Integration
- 
- - [ ] T043 [US2] Integrate React components in &#96;extension/ui/side-panel.tsx&#96;
- - [ ] T044 [US2] Setup Tailwind styles in &#96;extension/ui/side-panel.html&#96;
- - [ ] T045 [US2] Configure side panel in &#96;extension/manifest.json&#96; (side_panel field)
- - [ ] T046 [US2] Test side panel opens and displays correctly
- - [ ] T047 [US2] Test responsive layout at desktop widths (1024px+)
- - [ ] T048 [US2] Verify dark theme with glassmorphism effects render correctly
- - [ ] T049 [US2] Verify hover states and transitions work (200-300ms duration)
+ - UI displays title "CapThat!"
+ - Empty grid shows N slots (e.g., 10) with placeholders
+ - Action buttons are visible and styled
+ - UI is styled with Tailwind and usable at desktop widths
+ 
+ ### Implementation for User Story 2
+ 
+ - [ ] T034 [P] [US2] Setup React and Tailwind CSS in &#96;extension/ui/side-panel.tsx&#96; (import React, configure Tailwind)
+ - [ ] T035 [P] [US2] Create Header component at &#96;extension/ui/components/Header.tsx&#96; (display "CapThat!" title)
+ - [ ] T036 [P] [US2] Create ImageGrid component at &#96;extension/ui/components/ImageGrid.tsx&#96; (empty grid with N slots, placeholder support)
+ - [ ] T037 [P] [US2] Create ActionButton component at &#96;extension/ui/components/ActionButton.tsx&#96; (reusable button with states, hover effects)
+ - [ ] T038 [P] [US2] Create CapBoardPanel component at &#96;extension/ui/components/CapBoardPanel.tsx&#96; (main panel layout with Header, ImageGrid, action buttons)
+ - [ ] T039 [US2] Implement side panel entry point in &#96;extension/ui/side-panel.tsx&#96; (render CapBoardPanel, mount React app)
+ - [ ] T040 [US2] Configure side panel in &#96;extension/manifest.json&#96; (side_panel field with default_path)
+ - [ ] T041 [US2] Implement extension action button handler in &#96;extension/background/service-worker.ts&#96; (open side panel on click)
+ - [ ] T042 [US2] Add placeholder text to empty grid slots in &#96;extension/ui/components/ImageGrid.tsx&#96; ("Click Cap! to capture images")
+ - [ ] T043 [US2] Apply dark mode styling in &#96;extension/ui/globals.css&#96; (dark background, light text, glassmorphism effects)
+ - [ ] T044 [US2] Apply Tailwind styling to all components (teal/cyan accents, rounded corners, soft glows, transitions)
+ 
+ **Checkpoint**: At this point, User Story 2 should be fully functional and testable independently
+ 
+ ---
+ 
+ ## Phase 5: User Story 3 - Detect Capturable Images on Page (Priority: P2)
+ 
+ **Goal**: Extension identifies and marks capturable images on web pages without breaking page layout.
...
- **Checkpoint**: At this point, User Story 2 should be fully functional and testable independently
+ **Independent Test**: Visit page with images, verify extension injects capture controls or enables capture mode, verify page layout not broken, verify no console errors on common websites.
...
- ---
- 
- ## Phase 5: User Story 3 - Detect Capturable Images on Page (Priority: P2)
- 
- **Goal**: Extension identifies images on the page and enables capture mode.
- 
- **Independent Test**: Visit page with images, verify extension injects capture controls or enables capture mode without breaking page layout or producing console errors.
- 
- **Acceptance Criteria**:
- - Extension injects capture controls or enables capture mode
- - Images with valid sources are marked as capturable
- - Page layout is not broken, page interactions work normally
- - No console errors on common websites
- 
- ### Implementation for User Story 3
- 
- - [ ] T050 [US3] Implement image detection logic in &#96;extension/content/content-script.ts&#96; (querySelector for &#96;&lt;img&gt;&#96; elements)
- - [ ] T051 [US3] Filter valid image sources (http/https/data) in &#96;extension/content/content-script.ts&#96;
- - [ ] T052 [US3] Handle lazy-loaded images in &#96;extension/content/content-script.ts&#96;
- - [ ] T053 [US3] Inject "Cap!" buttons with isolation in &#96;extension/content/content-script.ts&#96;
- - [ ] T054 [US3] Setup message passing to service worker in &#96;extension/content/content-script.ts&#96;
- - [ ] T055 [US3] Verify isolated world usage (no unsafeWindow) in &#96;extension/content/content-script.ts&#96;
- - [ ] T056 [US3] Sanitize DOM manipulation in &#96;extension/content/content-script.ts&#96;
- - [ ] T057 [US3] Test XSS prevention (isolated world, sanitized DOM)
- - [ ] T058 [US3] Test content script injects without breaking pages on common websites
- 
- **Checkpoint**: At this point, User Story 3 should be fully functional and testable independently
- 
- ---
- 
- ## Phase 6: User Story 4 - Capture Image Using "Cap!" Button (Priority: P2)
- 
- **Goal**: Users can click "Cap!" on an image tile to add it to Cap Board.
- 
- **Independent Test**: Click "Cap!" on image, verify item appears in CapThat panel within 2 seconds with all required metadata, duplicate captures handled appropriately, 80/100 limit warnings shown.
- 
- **Acceptance Criteria**:
- - Item appears in panel within 2 seconds
- - Item includes image reference, source page URL, captured timestamp
- - Duplicate captures handled consistently (content hash matching)
- - Warning shown at 80 items, capture blocked at 100 items
- 
- ### Implementation for User Story 4
- 
- - [ ] T059 [US4] Implement capture request handler in &#96;extension/background/service-worker.ts&#96;
- - [ ] T060 [US4] Implement URL capture (primary) in &#96;extension/background/service-worker.ts&#96;
- - [ ] T061 [US4] Implement blob fetch (best-effort) in &#96;extension/background/service-worker.ts&#96;
- - [ ] T062 [US4] Handle CORS failures gracefully in &#96;extension/background/service-worker.ts&#96;
- - [ ] T063 [US4] Store fallback indicator in &#96;extension/background/service-worker.ts&#96;
- - [ ] T064 [US4] Implement duplicate detection (URL-based) in &#96;extension/background/service-worker.ts&#96;
- - [ ] T065 [US4] Generate thumbnail for grid in &#96;extension/background/service-worker.ts&#96;
- - [ ] T066 [US4] Save captured item to storage in &#96;extension/background/service-worker.ts&#96;
- - [ ] T067 [US4] Check board size before capture (80/100 limits) in &#96;extension/background/service-worker.ts&#96;
- - [ ] T068 [US4] Update UI on capture completion via storage events
+ **Acceptance Criteria**:
+ - Extension detects &#96;&lt;img&gt;&#96; elements with valid sources
+ - Images are marked as capturable
+ - Page layout is not broken
+ - No console errors on common websites
+ 
+ ### Implementation for User Story 3
+ 
+ - [ ] T045 [P] [US3] Implement image detection logic in &#96;extension/content/content-script.ts&#96; (scan for &#96;&lt;img&gt;&#96; elements, filter valid sources)
+ - [ ] T046 [US3] Inject capture controls into page in &#96;extension/content/content-script.ts&#96; (add "Cap!" buttons to image tiles, use isolated world)
+ - [ ] T047 [US3] Ensure content script uses isolated world in &#96;extension/manifest.json&#96; (verify world: "ISOLATED" for content scripts)
+ - [ ] T048 [US3] Implement CSS injection for capture controls in &#96;extension/content/content-script.ts&#96; (style buttons, ensure no layout breakage)
+ - [ ] T049 [US3] Add error handling for content script injection in &#96;extension/content/content-script.ts&#96; (catch errors, log to console, prevent page breakage)
+ - [ ] T050 [US3] Test on common websites (e-commerce, social media, content sites) and verify no console errors
+ 
+ **Checkpoint**: At this point, User Story 3 should be fully functional and testable independently
+ 
+ ---
+ 
+ ## Phase 6: User Story 4 - Capture Image Using "Cap!" Button (Priority: P2)
+ 
+ **Goal**: Users can click "Cap!" on an image and it appears in the CapThat panel within 2 seconds.
+ 
+ **Independent Test**: Click "Cap!" on an image, verify item appears in CapThat panel within 2 seconds with all required metadata, verify duplicate captures are handled appropriately, verify board limit warnings and enforcement.
+ 
+ **Acceptance Criteria**:
+ - Item appears in panel within 2 seconds
+ - Item includes image reference, source URL, timestamp
+ - Duplicate detection works (content hash matching)
+ - Warning shown at 80 items
+ - Capture prevented at 100 items
+ 
+ ### Implementation for User Story 4
+ 
+ - [ ] T051 [US4] Implement "Cap!" button click handler in &#96;extension/content/content-script.ts&#96; (send CAPTURE_REQUEST message to service worker)
+ - [ ] T052 [US4] Implement capture request handler in &#96;extension/background/service-worker.ts&#96; (receive CAPTURE_REQUEST, validate input)
+ - [ ] T053 [US4] Implement image fetch logic in &#96;extension/background/service-worker.ts&#96; (attempt to fetch image blob, handle CORS)
+ - [ ] T054 [US4] Implement content hash calculation in &#96;extension/background/service-worker.ts&#96; (calculate hash for duplicate detection)
+ - [ ] T055 [US4] Implement duplicate detection in &#96;extension/background/service-worker.ts&#96; (check content hash against existing items)
+ - [ ] T056 [US4] Create CapturedItem from capture in &#96;extension/background/service-worker.ts&#96; (generate UUID, create ImageReference, set timestamp)
+ - [ ] T057 [US4] Save captured item to storage in &#96;extension/background/service-worker.ts&#96; (use storage adapters, enforce 100 item limit)
+ - [ ] T058 [US4] Send storage update message to UI in &#96;extension/background/service-worker.ts&#96; (broadcast STORAGE_UPDATE with new item)
+ - [ ] T059 [US4] Implement capture response handler in &#96;extension/content/content-script.ts&#96; (receive CAPTURE_RESPONSE, show feedback)
+ - [ ] T060 [US4] Update ImageGrid to receive new items in &#96;extension/ui/components/ImageGrid.tsx&#96; (listen for STORAGE_UPDATE messages, add items to grid)
+ - [ ] T061 [US4] Implement board limit check in &#96;extension/background/service-worker.ts&#96; (check item count before save, emit warning at 80, prevent at 100)
+ - [ ] T062 [US4] Display board limit warning in &#96;extension/ui/components/CapBoardPanel.tsx&#96; (show warning message at 80 items)
+ 
+ **Checkpoint**: At this point, User Story 4 should be fully functional and testable independently
+ 
+ ---
+ 
+ ## Phase 7: User Story 5 - View Captured Items in Grid (Priority: P2)
+ 
+ **Goal**: Users can see captured items rendered as thumbnails in grid slots with metadata, and board state persists.
...
- **Checkpoint**: At this point, User Story 4 should be fully functional and testable independently
+ **Independent Test**: Capture multiple items, verify they render as thumbnails in grid slots with metadata, verify board state persists across refreshes and browser restarts.
...
- ---
- 
- ## Phase 7: User Story 5 - View Captured Items in Grid (Priority: P2)
- 
- **Goal**: Users can see captured items rendered as thumbnails in grid slots.
- 
- **Independent Test**: Capture multiple items, verify they render as thumbnails in grid slots with metadata, board state persists across refreshes and browser restarts.
- 
- **Acceptance Criteria**:
- - Empty grid slots display placeholders with capture hint text
- - Captured items render as thumbnails in grid slots
- - Grid cells show thumbnail and optional metadata
- - Virtual scrolling handles more than N items
- - Board state persists across refreshes and browser restarts
- 
- ### Implementation for User Story 5
- 
- - [ ] T069 [US5] Implement grid rendering in &#96;extension/ui/components/ImageGrid.tsx&#96; (render captured items as thumbnails)
- - [ ] T070 [US5] Implement empty state placeholders in &#96;extension/ui/components/ImageGrid.tsx&#96; ("Click Cap! to capture images")
- - [ ] T071 [US5] Implement virtual scrolling in &#96;extension/ui/components/ImageGrid.tsx&#96; (fixed slots, content scrolls)
- - [ ] T072 [US5] Load board data on panel open in &#96;extension/ui/side-panel.tsx&#96;
- - [ ] T073 [US5] Handle grid updates on capture/remove in &#96;extension/ui/components/ImageGrid.tsx&#96;
- - [ ] T074 [US5] Test board state persists across browser restarts
+ **Acceptance Criteria**:
+ - Items render as thumbnails in grid slots
+ - Grid cells show thumbnail and optional metadata
+ - Virtual scrolling works for 100+ items
+ - Board state persists across refreshes and browser restarts
+ 
+ ### Implementation for User Story 5
+ 
+ - [ ] T063 [P] [US5] Create ImageCard component at &#96;extension/ui/components/ImageCard.tsx&#96; (display thumbnail, metadata, handle loading states)
+ - [ ] T064 [US5] Implement thumbnail generation in &#96;extension/background/service-worker.ts&#96; (create base64 thumbnails for grid display)
+ - [ ] T065 [US5] Update ImageGrid to render ImageCard components in &#96;extension/ui/components/ImageGrid.tsx&#96; (map items to cards, handle empty slots)
+ - [ ] T066 [US5] Implement virtual scrolling in &#96;extension/ui/components/ImageGrid.tsx&#96; (fixed slots, content scrolls within slots for 100+ items)
+ - [ ] T067 [US5] Load board state on panel open in &#96;extension/ui/components/CapBoardPanel.tsx&#96; (request board from service worker on mount)
+ - [ ] T068 [US5] Implement board load handler in &#96;extension/background/service-worker.ts&#96; (load board from storage, send to UI)
+ - [ ] T069 [US5] Verify persistence across browser restart (capture items, close browser, reopen, verify items still visible)
+ 
+ **Checkpoint**: At this point, User Story 5 should be fully functional and testable independently
+ 
+ ---
+ 
+ ## Phase 8: User Story 6 - Remove a Captured Item (Priority: P3)
+ 
+ **Goal**: Users can remove individual items from the board without affecting other items.
...
- **Checkpoint**: At this point, User Story 5 should be fully functional and testable independently
+ **Independent Test**: Remove an individual item, verify it disappears immediately, verify it's removed from storage, verify other items remain intact.
...
- ---
- 
- ## Phase 8: User Story 8 - Persist Board Using Extension Storage (Priority: P2)
- 
- **Goal**: Board is saved automatically and loads when panel reopens.
- 
- **Independent Test**: Capture items, close and reopen panel, verify items load automatically, storage errors handled gracefully.
- 
- **Acceptance Criteria**:
- - Board metadata persisted using chrome.storage.local
- - Image blobs stored in IndexedDB
- - Previously captured items load automatically on panel open
- - Storage errors handled with non-blocking error messages
- 
- ### Implementation for User Story 8
- 
- - [ ] T075 [US8] Implement save board metadata in &#96;extension/storage/storage-adapter.ts&#96; (chrome.storage.local)
- - [ ] T076 [US8] Implement save image blobs in &#96;extension/storage/indexeddb-adapter.ts&#96;
- - [ ] T077 [US8] Implement load board on panel open in &#96;extension/ui/side-panel.tsx&#96;
- - [ ] T078 [US8] Handle storage errors gracefully in &#96;extension/storage/storage-adapter.ts&#96;
- - [ ] T079 [US8] Test board persistence across browser restarts
+ **Acceptance Criteria**:
+ - Remove control (X button) visible on each item
+ - Item disappears immediately on click
+ - Item removed from storage
+ - Other items remain intact
+ 
+ ### Implementation for User Story 6
+ 
+ - [ ] T070 [P] [US6] Add remove button to ImageCard component in &#96;extension/ui/components/ImageCard.tsx&#96; (X button with hover state)
+ - [ ] T071 [US6] Implement remove item handler in &#96;extension/ui/components/ImageCard.tsx&#96; (send BOARD_UPDATE message with remove action)
+ - [ ] T072 [US6] Implement remove item handler in &#96;extension/background/service-worker.ts&#96; (receive BOARD_UPDATE, remove item from board, save to storage)
+ - [ ] T073 [US6] Broadcast storage update after removal in &#96;extension/background/service-worker.ts&#96; (send STORAGE_UPDATE with remove action)
+ - [ ] T074 [US6] Update ImageGrid to handle item removal in &#96;extension/ui/components/ImageGrid.tsx&#96; (remove item from grid on STORAGE_UPDATE)
+ 
+ **Checkpoint**: At this point, User Story 6 should be fully functional and testable independently
+ 
+ ---
+ 
+ ## Phase 9: User Story 7 - Clear the Entire Cap Board (Priority: P3)
+ 
+ **Goal**: Users can clear the entire board with confirmation, removing all items from UI and storage.
...
- **Checkpoint**: At this point, User Story 8 should be fully functional and testable independently
+ **Independent Test**: Click "Clear Cap Board", confirm action, verify all items removed from UI and storage.
...
- ---
- 
- ## Phase 9: User Story 12 - Handle CORS-Blocked Images with Fallback (Priority: P2)
- 
- **Goal**: Extension captures images even when direct download fails due to CORS.
- 
- **Independent Test**: Attempt to capture CORS-blocked images, verify fallback mechanisms work, items added to board with usable thumbnail, users informed about fallback usage.
- 
- **Acceptance Criteria**:
- - System tries capture in order: store URL, attempt fetch blob, fallback to visible tab capture (optional v2)
- - Items added to board with usable thumbnail even when fallback used
- - Users informed via badge or tooltip when lower-quality fallback used
- 
- ### Implementation for User Story 12
- 
- - [ ] T080 [US12] Implement fallback capture strategy in &#96;extension/background/service-worker.ts&#96; (URL ‚Üí blob ‚Üí tab capture)
- - [ ] T081 [US12] Store fallback indicator in captured item metadata
- - [ ] T082 [US12] Display fallback badge/tooltip in &#96;extension/ui/components/ImageCard.tsx&#96;
- - [ ] T083 [US12] Test CORS-blocked image capture with fallback
- 
- **Checkpoint**: At this point, User Story 12 should be fully functional and testable independently
- 
- ---
- 
- ## Phase 10: User Story 6 - Remove a Captured Item (Priority: P3)
- 
- **Goal**: Users can remove individual captured items from the board.
- 
- **Independent Test**: Remove individual item, verify it disappears immediately, removed from storage, other items remain intact.
- 
- **Acceptance Criteria**:
- - Remove control (X button) available on each item
- - Item disappears immediately when removed
- - Item removed from storage
- - Other items remain on board
- 
- ### Implementation for User Story 6
- 
- - [ ] T084 [US6] Add remove button to items in &#96;extension/ui/components/ImageCard.tsx&#96;
- - [ ] T085 [US6] Implement remove handler in &#96;extension/ui/side-panel.tsx&#96;
- - [ ] T086 [US6] Update storage on remove in &#96;extension/storage/storage-adapter.ts&#96;
- - [ ] T087 [US6] Update UI on remove in &#96;extension/ui/components/ImageGrid.tsx&#96;
- 
- **Checkpoint**: At this point, User Story 6 should be fully functional and testable independently
- 
- ---
- 
- ## Phase 11: User Story 7 - Clear the Entire Cap Board (Priority: P3)
- 
- **Goal**: Users can clear the entire board with confirmation.
- 
- **Independent Test**: Click "Clear Cap Board", confirm action, verify all items removed from UI and storage.
- 
- **Acceptance Criteria**:
- - "Clear Cap Board" button available
- - Confirmation step (modal or confirm prompt) shown
- - All items removed from UI on confirmation
- - All stored items deleted from extension storage
- 
- ### Implementation for User Story 7
- 
- - [ ] T088 [US7] Implement clear button handler in &#96;extension/ui/components/CapBoardPanel.tsx&#96;
- - [ ] T089 [US7] Add confirmation modal in &#96;extension/ui/components/CapBoardPanel.tsx&#96;
- - [ ] T090 [US7] Clear storage on confirmation in &#96;extension/storage/storage-adapter.ts&#96;
- - [ ] T091 [US7] Reset UI on clear in &#96;extension/ui/components/ImageGrid.tsx&#96;
- 
- **Checkpoint**: At this point, User Story 7 should be fully functional and testable independently
- 
+ **Acceptance Criteria**:
+ - Clear button triggers confirmation step
+ - Confirmation can be confirmed or cancelled
+ - All items removed from UI on confirm
+ - All items deleted from storage on confirm
+ 
+ ### Implementation for User Story 7
+ 
+ - [ ] T075 [US7] Implement clear button handler in &#96;extension/ui/components/CapBoardPanel.tsx&#96; (show confirmation modal or confirm prompt)
+ - [ ] T076 [US7] Create confirmation modal component in &#96;extension/ui/components/CapBoardPanel.tsx&#96; (confirm/cancel buttons, glassmorphism styling)
+ - [ ] T077 [US7] Implement clear board handler in &#96;extension/ui/components/CapBoardPanel.tsx&#96; (send BOARD_UPDATE message with clear action on confirm)
+ - [ ] T078 [US7] Implement clear board handler in &#96;extension/background/service-worker.ts&#96; (receive BOARD_UPDATE, clear items array, save empty board to storage)
+ - [ ] T079 [US7] Broadcast storage update after clear in &#96;extension/background/service-worker.ts&#96; (send STORAGE_UPDATE with clear action and empty board)
+ - [ ] T080 [US7] Update ImageGrid to handle board clear in &#96;extension/ui/components/ImageGrid.tsx&#96; (clear all items on STORAGE_UPDATE clear action)
+ 
+ **Checkpoint**: At this point, User Story 7 should be fully functional and testable independently
+ 
+ ---
+ 
+ ## Phase 10: User Story 8 - Persist Board Using Extension Storage (Priority: P2)
+ 
+ **Goal**: Board data is automatically saved and loaded, with graceful error handling.
+ 
+ **Independent Test**: Capture items, close and reopen panel, verify items load automatically. Test storage errors handled gracefully.
+ 
+ **Acceptance Criteria**:
+ - Board metadata persisted using chrome.storage.local
+ - Image blobs stored in IndexedDB
+ - Items load automatically on panel open
+ - Storage errors handled gracefully with non-blocking messages
+ 
+ ### Implementation for User Story 8
+ 
+ - [ ] T081 [US8] Implement automatic save on capture in &#96;extension/background/service-worker.ts&#96; (save board to chrome.storage.local after each capture)
+ - [ ] T082 [US8] Implement automatic save on remove in &#96;extension/background/service-worker.ts&#96; (save board to chrome.storage.local after each removal)
+ - [ ] T083 [US8] Implement automatic save on clear in &#96;extension/background/service-worker.ts&#96; (save empty board to chrome.storage.local after clear)
+ - [ ] T084 [US8] Implement board load on panel open in &#96;extension/ui/components/CapBoardPanel.tsx&#96; (request board from service worker on component mount)
+ - [ ] T085 [US8] Implement board load handler in &#96;extension/background/service-worker.ts&#96; (load board from chrome.storage.local, load blobs from IndexedDB, send to UI)
+ - [ ] T086 [US8] Implement error handling for storage operations in &#96;extension/background/service-worker.ts&#96; (catch storage errors, send ERROR message with user-friendly text)
+ - [ ] T087 [US8] Display storage errors in UI in &#96;extension/ui/components/CapBoardPanel.tsx&#96; (show non-blocking toast for storage errors)
+ 
+ **Checkpoint**: At this point, User Story 8 should be fully functional and testable independently
+ 
+ ---
+ 
+ ## Phase 11: User Story 9 - Export Board Metadata as JSON (Priority: P3)
+ 
+ **Goal**: Users can export board data as a valid JSON file with all required metadata fields.
+ 
+ **Independent Test**: Click "Export JSON", verify .json file downloads with all required fields for each item, verify JSON validates (no circular refs, valid UTF-8).
+ 
+ **Acceptance Criteria**:
+ - JSON file downloads on click
+ - JSON includes id, image URL, source URL, timestamp, optional metadata for each item
+ - JSON validates (no circular refs, valid UTF-8)
+ 
+ ### Implementation for User Story 9
+ 
+ - [ ] T088 [US9] Implement export JSON button handler in &#96;extension/ui/components/CapBoardPanel.tsx&#96; (send EXPORT_REQUEST message with format: 'json')
+ - [ ] T089 [US9] Implement JSON export logic in &#96;extension/export/json-export.ts&#96; (serialize board to JSON, handle circular refs, ensure valid UTF-8)
+ - [ ] T090 [US9] Implement export request handler in &#96;extension/background/service-worker.ts&#96; (receive EXPORT_REQUEST, call export function, trigger download)
+ - [ ] T091 [US9] Implement file download in &#96;extension/background/service-worker.ts&#96; (use chrome.downloads API or createObjectURL for JSON download)
+ - [ ] T092 [US9] Send export response to UI in &#96;extension/background/service-worker.ts&#96; (send EXPORT_RESPONSE with success/failure)
+ - [ ] T093 [US9] Handle export response in UI in &#96;extension/ui/components/CapBoardPanel.tsx&#96; (show success/error message)
+ 
+ **Checkpoint**: At this point, User Story 9 should be fully functional and testable independently
+ 
...
- 
- ## Phase 12: User Story 9 - Export Board Metadata as JSON (Priority: P3)
- 
- **Goal**: Users can export board metadata as JSON file.
- 
- **Independent Test**: Click "Export JSON", verify valid JSON file downloads with all required metadata fields for each item.
- 
+ 
+ ## Phase 12: User Story 10 - Export Individual Captured Images (Priority: P3)
+ 
+ **Goal**: Users can export each captured image as separate files with consistent, unique filenames.
+ 
+ **Independent Test**: Click "Export Individual Caps", verify multiple image files download with consistent filenames (cap-&lt;timestamp&gt;-&lt;id&gt;.png), verify CORS-blocked images are skipped and reported.
+ 
...
- - .json file downloads on click
- - JSON includes for each item: id, image URL (or filename reference), source page URL, captured timestamp, optional metadata
- - JSON validates (no circular refs, valid UTF-8)
- 
- ### Implementation for User Story 9
- 
- - [ ] T092 [US9] Implement JSON export logic at &#96;extension/export/json-export.ts&#96;
- - [ ] T093 [US9] Generate JSON manifest with all metadata in &#96;extension/export/json-export.ts&#96;
- - [ ] T094 [US9] Validate JSON structure in &#96;extension/export/json-export.ts&#96;
- - [ ] T095 [US9] Download JSON via chrome.downloads API in &#96;extension/export/json-export.ts&#96;
- - [ ] T096 [US9] Wire export button to handler in &#96;extension/ui/components/CapBoardPanel.tsx&#96;
- 
- **Checkpoint**: At this point, User Story 9 should be fully functional and testable independently
- 
- ---
- 
- ## Phase 13: User Story 10 - Export Individual Captured Images (Priority: P3)
- 
- **Goal**: Users can export each captured image as separate files.
- 
- **Independent Test**: Click "Export Individual Caps", verify multiple image files download with consistent, unique filenames, CORS-blocked images handled appropriately.
- 
- **Acceptance Criteria**:
- - Multiple image files download on click
- - Filenames are consistent and unique (cap-&lt;timestamp&gt;-&lt;id&gt;.png)
- - CORS-blocked images skipped and reported in summary
- 
- ### Implementation for User Story 10
- 
- - [ ] T097 [US10] Implement individual image export logic at &#96;extension/export/image-export.ts&#96;
- - [ ] T098 [US10] Fetch images with CORS handling in &#96;extension/export/image-export.ts&#96;
- - [ ] T099 [US10] Generate unique filenames in &#96;extension/export/filename-sanitizer.ts&#96; (cap-&lt;timestamp&gt;-&lt;id&gt;.png)
- - [ ] T100 [US10] Sanitize filenames in &#96;extension/export/filename-sanitizer.ts&#96; (prevent path traversal)
- - [ ] T101 [US10] Download multiple files via chrome.downloads API in &#96;extension/export/image-export.ts&#96;
- - [ ] T102 [US10] Handle CORS-blocked images gracefully in &#96;extension/export/image-export.ts&#96;
- - [ ] T103 [US10] Wire export button to handler in &#96;extension/ui/components/CapBoardPanel.tsx&#96;
- 
- **Checkpoint**: At this point, User Story 10 should be fully functional and testable independently
- 
- ---
- 
- ## Phase 14: User Story 11 - Export Full Cap Board as ZIP (Priority: P3)
- 
- **Goal**: Users can export full board as single ZIP file.
- 
- **Independent Test**: Click "Export CapBoard", verify ZIP file downloads containing images folder and board.json manifest, completes successfully for boards up to 50 items.
- 
- **Acceptance Criteria**:
- - Single .zip file downloads on click
- - ZIP contains /images/ folder with images (if available) and board.json manifest
- - Export completes without crashing for boards up to 50 items
- 
- ### Implementation for User Story 11
- 
- - [ ] T104 [US11] Install JSZip dependency in &#96;package.json&#96;
- - [ ] T105 [US11] Implement ZIP export logic at &#96;extension/export/zip-export.ts&#96;
- - [ ] T106 [US11] Create ZIP structure with /images/ folder in &#96;extension/export/zip-export.ts&#96;
- - [ ] T107 [US11] Add board.json manifest to ZIP in &#96;extension/export/zip-export.ts&#96;
- - [ ] T108 [US11] Implement size limits in &#96;extension/export/zip-export.ts&#96; (prevent ZIP bombs)
- - [ ] T109 [US11] Download ZIP via chrome.downloads API in &#96;extension/export/zip-export.ts&#96;
- - [ ] T110 [US11] Wire export button to handler in &#96;extension/ui/components/CapBoardPanel.tsx&#96;
- 
- **Checkpoint**: At this point, User Story 11 should be fully functional and testable independently
- 
- ---
- 
- ## Phase 15: User Story 13 - Show Status Feedback for Actions (Priority: P3)
- 
- **Goal**: Users receive confirmation and error feedback for all actions.
- 
- **Independent Test**: Perform various actions (capture, export, clear), verify appropriate feedback messages appear without blocking user interaction except for clear confirmation.
- 
- **Acceptance Criteria**:
- - Toast appears "Captured" when "Cap!" clicked
- - "Exported successfully" message on export success
- - Toast notification with clear error message (permission/CORS/storage) and retry button on failure
- - No blocking alerts except for "Clear board confirmation"
- 
- ### Implementation for User Story 13
- 
- - [ ] T111 [US13] Create toast component at &#96;extension/ui/components/Toast.tsx&#96;
- - [ ] T112 [US13] Implement toast queue in &#96;extension/ui/components/Toast.tsx&#96;
- - [ ] T113 [US13] Show success messages (capture, export) in &#96;extension/ui/side-panel.tsx&#96;
- - [ ] T114 [US13] Show error messages with retry button in &#96;extension/ui/components/Toast.tsx&#96;
- - [ ] T115 [US13] Map errors to user-friendly messages in &#96;extension/ui/components/Toast.tsx&#96; (permission/CORS/storage categories)
- - [ ] T116 [US13] Implement retry functionality in &#96;extension/ui/components/Toast.tsx&#96;
- - [ ] T117 [US13] Ensure no internal paths exposed in error messages
- 
- **Checkpoint**: At this point, User Story 13 should be fully functional and testable independently
- 
- ---
- 
- ## Phase 16: User Story 14 - Send Captured Items to Local Next.js API (Priority: P4 - Optional Phase 2)
- 
- **Goal**: Extension posts captured items to local Next.js API when available.
- 
- **Independent Test**: Capture items, verify they are posted to local Next.js API when available, appropriate fallback behavior when app is not running.
- 
- **Acceptance Criteria**:
- - Extension posts captured payload to http://localhost:3000/api/capture when local app running
- - Extension falls back to extension-only storage when local app not running
- - "Local app not detected" message shown when app unavailable
- - Items stored and displayed in Next.js board view
- 
- ### Implementation for User Story 14
- 
- - [ ] T118 [US14] Create Next.js API endpoint at &#96;app/api/capture/route.ts&#96; (POST handler)
- - [ ] T119 [US14] Validate payload structure in &#96;app/api/capture/route.ts&#96;
- - [ ] T120 [US14] Store captures in local database/file system in &#96;app/api/capture/route.ts&#96;
- - [ ] T121 [US14] Return success/error response in &#96;app/api/capture/route.ts&#96;
- - [ ] T122 [US14] Detect localhost:3000 availability in &#96;extension/background/service-worker.ts&#96;
- - [ ] T123 [US14] Post capture payload to API in &#96;extension/background/service-worker.ts&#96;
- - [ ] T124 [US14] Handle timeouts in &#96;extension/background/service-worker.ts&#96;
- - [ ] T125 [US14] Fallback to extension storage when API unavailable in &#96;extension/background/service-worker.ts&#96;
- - [ ] T126 [US14] Validate localhost origin only in &#96;extension/background/service-worker.ts&#96;
- - [ ] T127 [US14] Create board view page at &#96;app/board/page.tsx&#96;
- - [ ] T128 [US14] Display captured items in board view in &#96;app/board/page.tsx&#96;
- 
- **Checkpoint**: At this point, User Story 14 should be fully functional and testable independently
- 
- ---
- 
- ## Phase 17: Polish &amp; Cross-Cutting Concerns
- 
- **Purpose**: Improvements that affect multiple user stories.
- 
- **Independent Test**: All security acceptance criteria pass, performance acceptable with 100 items, UI polished and accessible.
- 
- ### Security Hardening
- 
- - [ ] T129 Verify manifest permissions are minimal and justified (activeTab, storage, scripting, sidePanel)
- - [ ] T130 Test CSP violations are blocked (no eval, no inline scripts)
- - [ ] T131 Test XSS prevention in content scripts (isolated world, sanitized DOM)
- - [ ] T132 Test input validation with malicious URLs (javascript:, data: schemes)
- - [ ] T133 Test storage quota handling (warnings at 80% usage, errors at 100%)
- - [ ] T134 Verify export filename sanitization (no path traversal characters)
- - [ ] T135 Implement MIME type validation (JPEG, PNG, GIF, WebP only) in &#96;extension/validation/image-validator.ts&#96;
- - [ ] T136 Implement image size limits (10MB per image, 10MP dimensions) in &#96;extension/validation/image-validator.ts&#96;
- - [ ] T137 Verify error messages are user-friendly (no internal paths exposed)
- - [ ] T138 Test localhost API origin validation (reject non-localhost requests)
- 
- ### Performance Optimization
- 
- - [ ] T139 Optimize thumbnail rendering for 100 items in &#96;extension/ui/components/ImageGrid.tsx&#96;
- - [ ] T140 Implement lazy loading for images in &#96;extension/ui/components/ImageCard.tsx&#96;
- - [ ] T141 Test virtual scrolling performance with 100 items
- 
- ### Accessibility &amp; UX
- 
- - [ ] T142 Verify high contrast text on dark background (WCAG AA compliance)
- - [ ] T143 Verify keyboard navigation works (tab navigation, Enter/Space activation)
- - [ ] T144 Test all interactive elements have hover states
- - [ ] T145 Verify transitions are smooth (200-300ms, no jank)
- 
- ### Documentation
- 
- - [ ] T146 Create README.md at &#96;extension/README.md&#96; with setup and usage instructions
- - [ ] T147 Document security considerations in &#96;extension/SECURITY.md&#96;
- 
- ---
- 
- ## Dependencies &amp; Execution Order
- 
- ### Phase Dependencies
- 
- - **Setup (Phase 1)**: No dependencies - can start immediately
- - **Foundational (Phase 2)**: Depends on Setup completion - BLOCKS all user stories
- - **User Stories (Phase 3+)**: All depend on Foundational phase completion
-   - User stories can then proceed in parallel (if staffed)
-   - Or sequentially in priority order (P1 ‚Üí P2 ‚Üí P3)
- - **Polish (Final Phase)**: Depends on all desired user stories being complete
- 
- ### User Story Dependencies
- 
- - **User Story 1 (P1)**: Can start after Foundational (Phase 2) - No dependencies on other stories
- - **User Story 2 (P1)**: Can start after Foundational (Phase 2) - No dependencies on other stories
- - **User Story 3 (P2)**: Can start after Foundational (Phase 2) - No dependencies on other stories
- - **User Story 4 (P2)**: Depends on US3 (images must be detected before capture)
- - **User Story 5 (P2)**: Depends on US2 (UI needed), US4 (captures needed), US8 (persistence needed)
- - **User Story 6 (P3)**: Depends on US5 (grid needed)
- - **User Story 7 (P3)**: Depends on US5 (grid needed)
- - **User Story 8 (P2)**: Can start after US4 (captures needed) - Can run in parallel with US5
- - **User Story 9 (P3)**: Depends on US5 (board needed)
- - **User Story 10 (P3)**: Depends on US5 (board needed)
- - **User Story 11 (P3)**: Depends on US9, US10 (export components needed)
- - **User Story 12 (P2)**: Depends on US4 (capture needed) - Can run in parallel with US5, US8
- - **User Story 13 (P3)**: Depends on US4, US9, US10, US11, US7 (actions needed for feedback)
- - **User Story 14 (P4)**: Can start after US4 (capture needed) - Optional, can run independently
- 
- ### Within Each User Story
- 
- - Models before services
- - Services before endpoints/UI
- - Core implementation before integration
- - Story complete before moving to next priority
- 
- ### Parallel Opportunities
- 
- - All Setup tasks can run in parallel (different files)
- - All Foundational tasks marked [P] can run in parallel (within Phase 2)
- - Once Foundational phase completes, all user stories can start in parallel (if team capacity allows)
- - Models within a story marked [P] can run in parallel
- - Different user stories can be worked on in parallel by different team members
- 
- ---
- 
- ## Parallel Execution Examples
- 
- ### After Phase 2 (Foundational):
- &#96;&#96;&#96;bash
- # Launch all foundational tasks in parallel:
- Task: "Define TypeScript types at extension/types/index.ts"
- Task: "Define shared types at shared/types/index.ts"
- Task: "Implement chrome.storage.local adapter at extension/storage/storage-adapter.ts"
- Task: "Implement IndexedDB adapter at extension/storage/indexeddb-adapter.ts"
- Task: "Implement URL validator at extension/validation/url-validator.ts"
- Task: "Implement image validator at extension/validation/image-validator.ts"
- Task: "Define message types at extension/types/messages.ts"
- &#96;&#96;&#96;
- 
- ### After Phase 4 (US2 - Panel UI):
- &#96;&#96;&#96;bash
- # Launch UI components in parallel:
- Task: "Implement Header component at extension/ui/components/Header.tsx"
- Task: "Implement ActionButton component at extension/ui/components/ActionButton.tsx"
- Task: "Implement ImageCard component at extension/ui/components/ImageCard.tsx"
- Task: "Implement ImageGrid component at extension/ui/components/ImageGrid.tsx"
- Task: "Implement CapBoardPanel component at extension/ui/components/CapBoardPanel.tsx"
- &#96;&#96;&#96;
- 
- ### After Phase 6 (US4 - Capture):
- &#96;&#96;&#96;bash
- # Launch parallel stories:
- Task: "Implement grid rendering in extension/ui/components/ImageGrid.tsx" (US5)
- Task: "Implement save board metadata in extension/storage/storage-adapter.ts" (US8)
- Task: "Implement fallback capture strategy in extension/background/service-worker.ts" (US12)
- &#96;&#96;&#96;
- 
- ---
- 
- ## Implementation Strategy
- 
- ### MVP First (User Stories 1-2 Only)
- 
- 1. Complete Phase 1: Setup
- 2. Complete Phase 2: Foundational (CRITICAL - blocks all stories)
- 3. Complete Phase 3: User Story 1 (Load Extension)
- 4. Complete Phase 4: User Story 2 (Panel UI)
- 5. **STOP and VALIDATE**: Test User Stories 1-2 independently
- 6. Deploy/demo if ready
- 
- ### Incremental Delivery
- 
- 1. Complete Setup + Foundational ‚Üí Foundation ready
- 2. Add User Story 1 ‚Üí Test independently ‚Üí Deploy/Demo (Extension loads!)
- 3. Add User Story 2 ‚Üí Test independently ‚Üí Deploy/Demo (UI visible!)
- 4. Add User Story 3 ‚Üí Test independently ‚Üí Deploy/Demo (Images detected!)
- 5. Add User Story 4 ‚Üí Test independently ‚Üí Deploy/Demo (Capture works!)
- 6. Add User Story 5 ‚Üí Test independently ‚Üí Deploy/Demo (Grid displays!)
- 7. Each story adds value without breaking previous stories
- 
- ### Parallel Team Strategy
- 
- With multiple developers:
- 
- 1. Team completes Setup + Foundational together
- 2. Once Foundational is done:
-    - Developer A: User Story 1 (Load Extension)
-    - Developer B: User Story 2 (Panel UI)
- 3. Once US1 and US2 are done:
-    - Developer A: User Story 3 (Detect Images)
-    - Developer B: User Story 4 (Capture)
-    - Developer C: User Story 5 (View Grid) + US8 (Persistence)
- 4. Stories complete and integrate independently
- 
- ---
- 
- ## Task Summary
- 
- ### Total Tasks: 147
- 
- ### Tasks by Phase:
- - Phase 1 (Setup): 14 tasks
- - Phase 2 (Foundational): 14 tasks
- - Phase 3 (US1): 5 tasks
- - Phase 4 (US2): 16 tasks
- - Phase 5 (US3): 9 tasks
- - Phase 6 (US4): 10 tasks
- - Phase 7 (US5): 6 tasks
- - Phase 8 (US8): 5 tasks
- - Phase 9 (US12): 4 tasks
- - Phase 10 (US6): 4 tasks
- - Phase 11 (US7): 4 tasks
- - Phase 12 (US9): 5 tasks
- - Phase 13 (US10): 7 tasks
- - Phase 14 (US11): 7 tasks
- - Phase 15 (US13): 7 tasks
- - Phase 16 (US14): 11 tasks
- - Phase 17 (Polish): 20 tasks
- 
- ### Tasks by User Story:
- - US1 (P1): 5 tasks
- - US2 (P1): 16 tasks
- - US3 (P2): 9 tasks
- - US4 (P2): 10 tasks
- - US5 (P2): 6 tasks
- - US6 (P3): 4 tasks
- - US7 (P3): 4 tasks
- - US8 (P2): 5 tasks
- - US9 (P3): 5 tasks
- - US10 (P3): 7 tasks
- - US11 (P3): 7 tasks
- - US12 (P2): 4 tasks
- - US13 (P3): 7 tasks
- - US14 (P4): 11 tasks
- 
- ### Parallel Opportunities Identified:
- - 28 tasks marked with &#96;[P]&#96; can be worked on in parallel
- 
- ### Independent Test Criteria for Each Story:
- - **US1**: Extension loads in Chrome, appears in extensions list
- - **US2**: Panel opens and displays complete UI
- - **US3**: Images detected without breaking pages
- - **US4**: Capture adds item to board within 2 seconds
- - **US5**: Grid displays captured items, persists across restarts
- - **US6**: Remove item works, other items remain
- - **US7**: Clear board works with confirmation
- - **US8**: Board persists and loads automatically
- - **US9**: JSON export generates valid file
- - **US10**: Individual images export with unique filenames
- - **US11**: ZIP export completes for boards up to 50 items
- - **US12**: CORS-blocked images captured with fallback
- - **US13**: Status feedback appears for all actions
- - **US14**: Items posted to Next.js API when available
- 
- ### Suggested MVP Scope:
- - **MVP v1**: Phases 1-4 (Setup + Foundational + US1 + US2)
-   - Total MVP tasks: 49 tasks
-   - Delivers: Extension loads, panel UI displays, foundation for all features
- 
- ---
- 
- ## Format Validation
- 
- ‚úÖ All tasks follow the strict checklist format:
- - Checkbox: &#96;- [ ]&#96;
- - Task ID: &#96;T001&#96;, &#96;T002&#96;, etc.
- - Parallel marker: &#96;[P]&#96; where applicable
- - Story label: &#96;[US1]&#96;, &#96;[US2]&#96;, etc. for user story phases
- - Description: Clear action with exact file path
- 
- ---
- 
- **End of Tasks Document**
- 
+ - Multiple image files download
+ - Filenames are consistent and unique (cap-&lt;timestamp&gt;-&lt;id&gt;.png)
+ - CORS-blocked images are skipped and reported in summary
+ 
+ ### Implementation for User Story 10
+ 
+ - [ ] T094 [US10] Implement export individual images button handler in &#96;extension/ui/components/CapBoardPanel.tsx&#96; (send EXPORT_REQUEST message with format: 'individual')
+ - [ ] T095 [US10] Implement filename sanitizer in &#96;extension/export/filename-sanitizer.ts&#96; (remove /, \, .., etc., ensure unique filenames)
+ - [ ] T096 [US10] Implement individual image export logic in &#96;extension/export/json-export.ts&#96; (iterate items, download each image, handle CORS failures)
+ - [ ] T097 [US10] Implement image download with retry in &#96;extension/export/json-export.ts&#96; (attempt fetch, handle CORS, skip if blocked)
+ - [ ] T098 [US10] Track skipped images in export in &#96;extension/export/json-export.ts&#96; (count CORS-blocked images)
+ - [ ] T099 [US10] Send export response with skipped count in &#96;extension/background/service-worker.ts&#96; (include skippedCount in EXPORT_RESPONSE)
+ - [ ] T100 [US10] Display export summary in UI in &#96;extension/ui/components/CapBoardPanel.tsx&#96; (show skipped count if &gt; 0)
+ 
+ **Checkpoint**: At this point, User Story 10 should be fully functional and testable independently
+ 
+ ---
+ 
+ ## Phase 13: User Story 11 - Export Full Cap Board as ZIP (Priority: P3)
+ 
+ **Goal**: Users can export the entire board as a ZIP file containing images folder and board.json manifest.
+ 
+ **Independent Test**: Click "Export CapBoard", verify .zip file downloads containing /images/ folder and board.json, verify export completes for boards up to 50 items without crashing.
+ 
+ **Acceptance Criteria**:
+ - ZIP file downloads on click
+ - ZIP contains /images/ folder with images (if available)
+ - ZIP contains board.json manifest
+ - Export completes for boards up to 50 items
+ 
+ ### Implementation for User Story 11
+ 
+ - [ ] T101 [US11] Implement export ZIP button handler in &#96;extension/ui/components/CapBoardPanel.tsx&#96; (send EXPORT_REQUEST message with format: 'zip')
+ - [ ] T102 [US11] Install JSZip dependency in &#96;package.json&#96; (add jszip package)
+ - [ ] T103 [US11] Implement ZIP export logic in &#96;extension/export/zip-export.ts&#96; (create ZIP with JSZip, add images to /images/ folder, add board.json)
+ - [ ] T104 [US11] Generate board.json manifest in &#96;extension/export/zip-export.ts&#96; (create ExportManifest with board metadata, item references, export timestamp)
+ - [ ] T105 [US11] Add images to ZIP in &#96;extension/export/zip-export.ts&#96; (iterate items, add images to /images/ folder, handle CORS-blocked images)
+ - [ ] T106 [US11] Implement ZIP download in &#96;extension/background/service-worker.ts&#96; (generate ZIP blob, trigger download)
+ - [ ] T107 [US11] Handle large boards (50+ items) in &#96;extension/export/zip-export.ts&#96; (stream or chunk processing to prevent memory issues)
+ - [ ] T108 [US11] Send export response to UI in &#96;extension/background/service-worker.ts&#96; (send EXPORT_RESPONSE with success/failure)
+ 
+ **Checkpoint**: At this point, User Story 11 should be fully functional and testable independently
+ 
+ ---
+ 
+ ## Phase 14: User Story 12 - Handle CORS-Blocked Images with Fallback (Priority: P2)
+ 
+ **Goal**: Extension captures images even when direct download fails, using fallback strategies.
+ 
+ **Independent Test**: Attempt to capture CORS-blocked images, verify fallback mechanisms work (URL storage, blob fetch attempt, optional tab capture), verify items still added to board with usable thumbnails, verify users informed about fallback usage.
+ 
+ **Acceptance Criteria**:
+ - System attempts capture in order: store URL, attempt fetch blob, fallback to visible tab capture (optional v2)
+ - Items added to board even when fallback used
+ - Users informed via badge or tooltip when fallback used
+ 
+ ### Implementation for User Story 12
+ 
+ - [ ] T109 [US12] Implement CORS fallback strategy in &#96;extension/background/service-worker.ts&#96; (try URL storage first, then blob fetch, then tab capture)
+ - [ ] T110 [US12] Implement URL-only storage fallback in &#96;extension/background/service-worker.ts&#96; (store image URL when blob fetch fails)
+ - [ ] T111 [US12] Implement blob fetch attempt in &#96;extension/background/service-worker.ts&#96; (attempt fetch with CORS handling, catch errors)
+ - [ ] T112 [US12] Set qualityIndicator on CapturedItem in &#96;extension/background/service-worker.ts&#96; (set to 'url-only', 'blob', or 'fallback' based on capture method)
+ - [ ] T113 [US12] Display fallback indicator in ImageCard in &#96;extension/ui/components/ImageCard.tsx&#96; (show badge or tooltip when qualityIndicator is 'url-only' or 'fallback')
+ - [ ] T114 [US12] Generate thumbnail from URL when blob unavailable in &#96;extension/background/service-worker.ts&#96; (create thumbnail from URL for grid display)
+ 
+ **Checkpoint**: At this point, User Story 12 should be fully functional and testable independently
+ 
+ ---
+ 
+ ## Phase 15: User Story 13 - Show Status Feedback for Actions (Priority: P3)
+ 
+ **Goal**: Users receive confirmation and error feedback for all actions without blocking interaction.
+ 
+ **Independent Test**: Perform various actions (capture, export, clear), verify appropriate feedback messages appear (toast notifications), verify no blocking alerts except clear confirmation.
+ 
+ **Acceptance Criteria**:
+ - Toast appears on capture: "Captured"
+ - Toast appears on export success: "Exported successfully"
+ - Toast appears on errors with clear message and retry button
+ - No blocking alerts except clear confirmation
+ 
+ ### Implementation for User Story 13
+ 
+ - [ ] T115 [P] [US13] Create toast notification component in &#96;extension/ui/components/Toast.tsx&#96; (non-blocking toast with message, auto-dismiss, retry button support)
+ - [ ] T116 [US13] Implement toast state management in &#96;extension/ui/components/CapBoardPanel.tsx&#96; (toast queue, show/hide logic)
+ - [ ] T117 [US13] Show "Captured" toast on successful capture in &#96;extension/ui/components/CapBoardPanel.tsx&#96; (listen for STORAGE_UPDATE add action)
+ - [ ] T118 [US13] Show "Exported successfully" toast on export success in &#96;extension/ui/components/CapBoardPanel.tsx&#96; (listen for EXPORT_RESPONSE success)
+ - [ ] T119 [US13] Show error toast with retry button on failure in &#96;extension/ui/components/CapBoardPanel.tsx&#96; (listen for ERROR messages, show retry button if retryable)
+ - [ ] T120 [US13] Implement retry logic in &#96;extension/ui/components/CapBoardPanel.tsx&#96; (retry failed action on retry button click)
+ - [ ] T121 [US13] Format error messages by category in &#96;extension/ui/components/CapBoardPanel.tsx&#96; (show user-friendly messages for permission/CORS/storage/validation errors)
+ 
+ **Checkpoint**: At this point, User Story 13 should be fully functional and testable independently
+ 
+ ---
+ 
+ ## Phase 16: User Story 14 - Send Captured Items to Local Next.js API (Priority: P4 - Optional Phase 2)
+ 
+ **Goal**: Extension can send captured items to local Next.js app when available, with graceful fallback.
+ 
+ **Independent Test**: Capture items with local app running, verify items posted to http://localhost:3000/api/capture. Test with app not running, verify fallback to extension storage. Test app detection, verify "Local app not detected" message.
+ 
+ **Acceptance Criteria**:
+ - Items posted to http://localhost:3000/api/capture when app running
+ - Fallback to extension storage when app not running
+ - "Local app not detected" message shown when app unavailable
+ - Items stored and displayed in Next.js board page
+ 
+ ### Implementation for User Story 14
+ 
+ - [ ] T122 [US14] Create Next.js API route at &#96;app/api/capture/route.ts&#96; (POST handler, validate origin, accept capture payload)
+ - [ ] T123 [US14] Implement CORS handling in Next.js API in &#96;app/api/capture/route.ts&#96; (allow chrome-extension:// origins)
+ - [ ] T124 [US14] Implement payload validation in Next.js API in &#96;app/api/capture/route.ts&#96; (validate itemId, sourceUrl, timestamp, imageReference)
+ - [ ] T125 [US14] Store captured items in Next.js in &#96;app/api/capture/route.ts&#96; (save to database or file system)
+ - [ ] T126 [US14] Create board page at &#96;app/board/page.tsx&#96; (display captured items from Next.js storage)
+ - [ ] T127 [US14] Implement local app detection in &#96;extension/background/service-worker.ts&#96; (ping http://localhost:3000/api/capture to check availability)
+ - [ ] T128 [US14] Implement API client in &#96;extension/background/service-worker.ts&#96; (send POST request to http://localhost:3000/api/capture with captured item)
+ - [ ] T129 [US14] Implement origin validation in &#96;extension/background/service-worker.ts&#96; (validate requests only go to http://localhost:3000)
+ - [ ] T130 [US14] Implement fallback to extension storage in &#96;extension/background/service-worker.ts&#96; (if API unavailable, use extension storage)
+ - [ ] T131 [US14] Show "Local app not detected" message in UI in &#96;extension/ui/components/CapBoardPanel.tsx&#96; (non-blocking message when app unavailable)
+ - [ ] T132 [US14] Handle API errors gracefully in &#96;extension/background/service-worker.ts&#96; (catch network errors, validation errors, fallback to extension storage)
+ 
+ **Checkpoint**: At this point, User Story 14 should be fully functional and testable independently
+ 
+ ---
+ 
+ ## Phase 17: Polish &amp; Cross-Cutting Concerns
+ 
+ **Purpose**: Improvements that affect multiple user stories.
+ 
+ - [ ] T133 [P] Update documentation in &#96;README.md&#96; (extension setup, usage, development guide)
+ - [ ] T134 [P] Code cleanup and refactoring (review all files, remove dead code, improve naming)
+ - [ ] T135 [P] Performance optimization (optimize image loading, virtual scrolling, storage operations)
+ - [ ] T136 [P] Security review (verify CSP compliance, input validation, storage quota handling)
+ - [ ] T137 [P] Accessibility improvements (keyboard navigation, ARIA labels, contrast checks)
+ - [ ] T138 [P] Error handling improvements (comprehensive error messages, retry logic, logging)
+ - [ ] T139 [P] Run quickstart.md validation (test all user scenarios from quickstart.md)
+ - [ ] T140 [P] Final testing across all user stories (end-to-end testing, browser compatibility)
+ 
+ ---
+ 
+ ## Dependencies &amp; Execution Order
+ 
+ ### Phase Dependencies
+ 
+ - **Setup (Phase 1)**: No dependencies - can start immediately
+ - **Foundational (Phase 2)**: Depends on Setup completion - BLOCKS all user stories
+ - **User Stories (Phase 3-16)**: All depend on Foundational phase completion
+   - User stories can then proceed in parallel (if staffed)
+   - Or sequentially in priority order (P1 ‚Üí P2 ‚Üí P3 ‚Üí P4)
+ - **Polish (Phase 17)**: Depends on all desired user stories being complete
+ 
+ ### User Story Dependencies
+ 
+ - **User Story 1 (P1)**: Can start after Foundational (Phase 2) - No dependencies on other stories
+ - **User Story 2 (P1)**: Can start after Foundational (Phase 2) - No dependencies on other stories
+ - **User Story 3 (P2)**: Can start after Foundational (Phase 2) - No dependencies on other stories
+ - **User Story 4 (P2)**: Depends on User Story 2 (needs panel UI) and User Story 3 (needs image detection) - Can start after US2 and US3
+ - **User Story 5 (P2)**: Depends on User Story 4 (needs captured items) - Can start after US4
+ - **User Story 6 (P3)**: Depends on User Story 5 (needs grid display) - Can start after US5
+ - **User Story 7 (P3)**: Depends on User Story 5 (needs grid display) - Can start after US5
+ - **User Story 8 (P2)**: Depends on User Story 4 (needs capture functionality) - Can start after US4
+ - **User Story 9 (P3)**: Depends on User Story 5 (needs board data) - Can start after US5
+ - **User Story 10 (P3)**: Depends on User Story 5 (needs board data) - Can start after US5
+ - **User Story 11 (P3)**: Depends on User Story 5 (needs board data) - Can start after US5
+ - **User Story 12 (P2)**: Depends on User Story 4 (needs capture functionality) - Can start after US4
+ - **User Story 13 (P3)**: Depends on User Stories 4, 9, 10, 11 (needs actions to provide feedback for) - Can start after US4
+ - **User Story 14 (P4)**: Depends on User Story 4 (needs capture functionality) - Optional Phase 2, can start after US4
+ 
+ ### Within Each User Story
+ 
+ - Models/types before services
+ - Services before UI components
+ - Core implementation before integration
+ - Story complete before moving to next priority
+ 
+ ### Parallel Opportunities
+ 
+ - All Setup tasks (T001-T014) can run in parallel where they touch different files
+ - All Foundational tasks marked [P] (T015-T028) can run in parallel
+ - Once Foundational phase completes, User Stories 1, 2, and 3 can start in parallel
+ - User Stories 4, 8, and 12 can start in parallel after US2 and US3 complete
+ - User Stories 6, 7, 9, 10, 11 can start in parallel after US5 completes
+ - All tasks marked [P] within a user story can run in parallel
+ - Different user stories can be worked on in parallel by different team members
+ 
+ ---
+ 
+ ## Parallel Example: User Story 2
+ 
+ &#96;&#96;&#96;bash
+ # Launch all component creation tasks in parallel:
+ Task: "Create Header component at extension/ui/components/Header.tsx"
+ Task: "Create ImageGrid component at extension/ui/components/ImageGrid.tsx"
+ Task: "Create ActionButton component at extension/ui/components/ActionButton.tsx"
+ Task: "Create CapBoardPanel component at extension/ui/components/CapBoardPanel.tsx"
+ &#96;&#96;&#96;
+ 
+ ---
+ 
+ ## Parallel Example: User Story 4
+ 
+ &#96;&#96;&#96;bash
+ # Launch foundational tasks in parallel (after Phase 2):
+ Task: "Implement 'Cap!' button click handler in extension/content/content-script.ts"
+ Task: "Implement capture request handler in extension/background/service-worker.ts"
+ Task: "Implement image fetch logic in extension/background/service-worker.ts"
+ Task: "Implement content hash calculation in extension/background/service-worker.ts"
+ &#96;&#96;&#96;
+ 
+ ---
+ 
+ ## Implementation Strategy
+ 
+ ### MVP First (User Stories 1 &amp; 2 Only)
+ 
+ 1. Complete Phase 1: Setup
+ 2. Complete Phase 2: Foundational (CRITICAL - blocks all stories)
+ 3. Complete Phase 3: User Story 1 (Load Extension)
+ 4. Complete Phase 4: User Story 2 (Show Panel UI)
+ 5. **STOP and VALIDATE**: Test User Stories 1 and 2 independently
+ 6. Deploy/demo if ready
+ 
+ ### Incremental Delivery
+ 
+ 1. Complete Setup + Foundational ‚Üí Foundation ready
+ 2. Add User Story 1 ‚Üí Test independently ‚Üí Deploy/Demo (Extension loads!)
+ 3. Add User Story 2 ‚Üí Test independently ‚Üí Deploy/Demo (UI visible!)
+ 4. Add User Story 3 ‚Üí Test independently ‚Üí Deploy/Demo (Image detection!)
+ 5. Add User Story 4 ‚Üí Test independently ‚Üí Deploy/Demo (Capture works!)
+ 6. Add User Story 5 ‚Üí Test independently ‚Üí Deploy/Demo (Grid display!)
+ 7. Add User Story 8 ‚Üí Test independently ‚Üí Deploy/Demo (Persistence!)
+ 8. Add User Story 12 ‚Üí Test independently ‚Üí Deploy/Demo (CORS handling!)
+ 9. Add remaining stories ‚Üí Test independently ‚Üí Deploy/Demo
+ 10. Each story adds value without breaking previous stories
+ 
+ ### Parallel Team Strategy
+ 
+ With multiple developers:
+ 
+ 1. Team completes Setup + Foundational together
+ 2. Once Foundational is done:
+    - Developer A: User Story 1 (Load Extension)
+    - Developer B: User Story 2 (Panel UI)
+    - Developer C: User Story 3 (Image Detection)
+ 3. After US1, US2, US3 complete:
+    - Developer A: User Story 4 (Capture)
+    - Developer B: User Story 8 (Persistence)
+    - Developer C: User Story 12 (CORS Fallback)
+ 4. After US4, US5 complete:
+    - Developer A: User Story 6 (Remove Item)
+    - Developer B: User Story 7 (Clear Board)
+    - Developer C: User Story 9 (Export JSON)
+ 5. Stories complete and integrate independently
+ 
+ ---
+ 
+ ## Task Summary
+ 
+ **Total Tasks**: 140
+ 
+ **Tasks by Phase**:
+ - Phase 1 (Setup): 14 tasks
+ - Phase 2 (Foundational): 14 tasks
+ - Phase 3 (US1): 5 tasks
+ - Phase 4 (US2): 11 tasks
+ - Phase 5 (US3): 6 tasks
+ - Phase 6 (US4): 12 tasks
+ - Phase 7 (US5): 7 tasks
+ - Phase 8 (US6): 5 tasks
+ - Phase 9 (US7): 6 tasks
+ - Phase 10 (US8): 7 tasks
+ - Phase 11 (US9): 6 tasks
+ - Phase 12 (US10): 7 tasks
+ - Phase 13 (US11): 8 tasks
+ - Phase 14 (US12): 6 tasks
+ - Phase 15 (US13): 7 tasks
+ - Phase 16 (US14): 11 tasks
+ - Phase 17 (Polish): 8 tasks
+ 
+ **Tasks by User Story**:
+ - User Story 1: 5 tasks
+ - User Story 2: 11 tasks
+ - User Story 3: 6 tasks
+ - User Story 4: 12 tasks
+ - User Story 5: 7 tasks
+ - User Story 6: 5 tasks
+ - User Story 7: 6 tasks
+ - User Story 8: 7 tasks
+ - User Story 9: 6 tasks
+ - User Story 10: 7 tasks
+ - User Story 11: 8 tasks
+ - User Story 12: 6 tasks
+ - User Story 13: 7 tasks
+ - User Story 14: 11 tasks
+ 
+ **Parallel Opportunities Identified**:
+ - Phase 2: 14 tasks marked [P] can run in parallel
+ - User Story 2: 5 component creation tasks can run in parallel
+ - User Stories 1, 2, 3: Can start in parallel after Phase 2
+ - User Stories 4, 8, 12: Can start in parallel after US2 and US3
+ - User Stories 6, 7, 9, 10, 11: Can start in parallel after US5
+ 
+ **Independent Test Criteria**:
+ - US1: Extension loads in Chrome, appears in extensions list
+ - US2: Panel opens and displays complete UI
+ - US3: Images detected without breaking page layout
+ - US4: Capture works within 2 seconds with duplicate handling
+ - US5: Items render in grid and persist across restarts
+ - US6: Individual items can be removed
+ - US7: Entire board can be cleared with confirmation
+ - US8: Board persists and loads automatically
+ - US9: JSON export generates valid file
+ - US10: Individual images export with unique filenames
+ - US11: ZIP export contains images and manifest
+ - US12: CORS-blocked images handled with fallback
+ - US13: Status feedback appears for all actions
+ - US14: Items sent to Next.js API when available
+ 
+ **Suggested MVP Scope**: User Stories 1 and 2 (Load Extension + Show Panel UI) provide the foundation. For a functional MVP, add User Stories 3, 4, 5, 8, and 12 (Image Detection + Capture + Grid Display + Persistence + CORS Handling).
+ 
+ ---
+ 
+ ## Notes
+ 
+ - [P] tasks = different files, no dependencies
+ - [Story] label maps task to specific user story for traceability
+ - Each user story should be independently completable and testable
+ - Commit after each task or logical group
+ - Stop at any checkpoint to validate story independently
+ - Avoid: vague tasks, same file conflicts, cross-story dependencies that break independence
+ - All tasks follow strict checklist format: &#96;- [ ] [TaskID] [P?] [Story?] Description with file path&#96;
+ 
```

</details>

</tool-use>

---



---


Updating todos and checking for issues:


---

<tool-use data-tool-type="task" data-tool-name="todo_write">
<details><summary>Tool use: **todo_write** ‚Ä¢ Todo List</summary>

- [x] Read all design documents (plan.md, spec.md, data-model.md, contracts, research.md)
- [x] Generate tasks.md organized by user story with proper checklist format
- [x] Validate task format and dependencies

</details>
</tool-use>

---

<tool-use data-tool-type="generic" data-tool-name="read_lints">
<details>
          <summary>Tool use: **read_lints** ‚Ä¢ Read lints for 1 file</summary>
      
Lint paths:

- `specs/001-capthat-extension/tasks.md`

Lint results


**No lint errors found**
</details>
</tool-use>

---



---


Generated `tasks.md` for the CapThat Chrome Extension. Summary:

## Generated Tasks Summary

**Total Tasks**: 140 tasks organized across 17 phases

### Phase Breakdown:
- **Phase 1 (Setup)**: 14 tasks - Project initialization and build pipeline
- **Phase 2 (Foundational)**: 14 tasks - Core infrastructure (types, storage, validation, messages) - **BLOCKS all user stories**
- **Phases 3-16**: User stories in priority order (P1 ‚Üí P2 ‚Üí P3 ‚Üí P4)
- **Phase 17 (Polish)**: 8 tasks - Cross-cutting concerns

### User Story Coverage:
- **User Story 1 (P1)**: Load Extension in Chrome - 5 tasks
- **User Story 2 (P1)**: Show CapThat Panel UI - 11 tasks
- **User Story 3 (P2)**: Detect Capturable Images - 6 tasks
- **User Story 4 (P2)**: Capture Image Using "Cap!" Button - 12 tasks
- **User Story 5 (P2)**: View Captured Items in Grid - 7 tasks
- **User Story 6 (P3)**: Remove a Captured Item - 5 tasks
- **User Story 7 (P3)**: Clear the Entire Cap Board - 6 tasks
- **User Story 8 (P2)**: Persist Board Using Extension Storage - 7 tasks
- **User Story 9 (P3)**: Export Board Metadata as JSON - 6 tasks
- **User Story 10 (P3)**: Export Individual Captured Images - 7 tasks
- **User Story 11 (P3)**: Export Full Cap Board as ZIP - 8 tasks
- **User Story 12 (P2)**: Handle CORS-Blocked Images with Fallback - 6 tasks
- **User Story 13 (P3)**: Show Status Feedback for Actions - 7 tasks
- **User Story 14 (P4)**: Send Captured Items to Local Next.js API - 11 tasks

### Features:
- All tasks follow the checklist format: `- [ ] [TaskID] [P?] [Story?] Description with file path`
- Tasks organized by user story for independent implementation
- Parallel opportunities marked with [P]
- Story labels [US1], [US2], etc. for traceability
- Clear file paths for each task
- Dependency graph showing execution order
- Independent test criteria for each story
- MVP scope suggestion (User Stories 1 & 2 minimum)

The tasks.md file is ready for implementation. Each task is specific enough that an LLM can complete it without additional context, and all tasks include exact file paths as required.

---

